---
title: "Bellabeat Case Study"
author: "Marcus Madison"
date: '2022-05-11'
output:
  pdf_document: default
  html_document: default
---

```{r include=FALSE}
r = getOption("repos")
r["CRAN"] = "http://cran.us.r-project.org"
options(repos = r)
```

#About Bellabeat

Bellabeat is a high tech manufacturer of health based products for women, and even though small they have been quite successful. Urška Sršen, co-founder and Chief Creative Officer of Bellabeat, knows the company has potential to be a major player in the global smart device market and believes that by analyzing smart device data new growth potential can be found. 

##Main Questions

1.What are some trends in smart device usage?

2.How could these trends apply to Bellabeat customers?

3.How could these trends help influence Bellabeat marketing strategy?

##Business Task

Analyze data on smart device usage on non-Bellabeat smart devices, then use those insights to provide recommendations for Bellabeat marketing strategy improvement.

#Data Preparation

Installed and Loaded packages that would be necesary for the preparation and analysis of the data.
```{r installing and loading packages, include=FALSE}
install.packages("ggplot2")
install.packages("dplyr")
install.packages("tidyr")
install.packages("lubridate")
install.packages("readr")
install.packages("tidyverse")
install.packages("here")
library(here)
library(tidyverse)
library(lubridate)
library(tidyr)
library(ggplot2)
library(readr)
library(dplyr)

```


Then imported the data into R Studio, which had already been cleaned and validated in in Sheets prior. All data was taken from a zip file provided by Mobius on Kaggle. They provided fitbit fitness tracker data that was to be used in this analysis.
```{r importing datasets into R studio, echo=TRUE}
sleepDay <- read_csv(" sleepDay.csv")
dailyActivity <- read_csv("daily_activity.csv")
dailyCalories <- read_csv("dailyCalories.csv")
dailyIntensities <- read_csv("dailyIntensities.csv")
dailySteps <- read_csv("dailySteps.csv")
heartrate_seconds_merged <- read_csv("heartrate_seconds_merged.csv")
hourlyCalories <- read_csv("hourlyCalories.csv")
hourlyIntensities <- read_csv("hourlyIntensities.csv")
weightLogInfo <- read_csv("weightLogInfo.csv")

```

To make sure they were imported correctly I used the head fucntion to take a look at the csv files as dataframes
```{r opening up dataframes, echo=FALSE}
head(hourlyCalories)
head(hourlyIntensities)
head(dailyActivity)
head(dailyCalories)
head(dailyIntensities)
head(dailySteps)
head(sleepDay)
head(heartrate_seconds_merged)
head(weightLogInfo)

```

After importing the data, I noticed that the data type for the date needed to be updated for the dataframes, using lubridate I updated the data frames.
```{r updating the data types, include=FALSE}

dailyCalories$ActivityDay <-mdy(dailyCalories$ActivityDay)
head(dailyCalories) 
dailyIntensities$ActivityDay <-mdy(dailyIntensities$ActivityDay)
head(dailyIntensities)
dailySteps$ActivityDay <-mdy(dailySteps$ActivityDay)
head(dailySteps)
dailyActivity$ActivityDate <-mdy(dailyActivity$ActivityDate)
head(dailyActivity)
hourlyCalories$ActivityHour <-mdy_hms(hourlyCalories$ActivityHour)
head(hourlyCalories)
hourlyIntensities$ActivityHour <-mdy_hms(hourlyIntensities$ActivityHour)
head(hourlyIntensities)
sleepDay$SleepDay <-mdy_hms(sleepDay$SleepDay)
head(sleepDay)
heartrate_seconds_merged$Time <-mdy_hms(heartrate_seconds_merged$Time)
head(heartrate_seconds_merged)
weightLogInfo$Date <-mdy_hms(weightLogInfo$Date)
head(weightLogInfo)


```
Now that the dates are in the correct format, I had to separate the date columns in certain data frames that contained both the date and time in a single column. This was done using the separate function.
```{r splitting datetime into date and time columns, echo=TRUE}

heartrate_seconds_merged<-separate(heartrate_seconds_merged,Time,c("Date","Time"),sep = " ")
weightLogInfo<-separate(weightLogInfo,Date,c("Date","Time"),sep = " ")
hourlyCalories<-separate(hourlyCalories,ActivityHour,c("Date","Time"),sep = " ")
hourlyIntensities<-separate(hourlyIntensities,ActivityHour,c("Date","Time"),sep = " ")

```

Next I check the sample size of the data sets I am choosing to analyze, usually a sample size of over 25 is reliable enough to analyze due to the variety of subjects.
```{r checking sample size, echo=TRUE}

n_distinct(dailyActivity$Id)
n_distinct(heartrate_seconds_merged$Id)
n_distinct(weightLogInfo$Id)
n_distinct(hourlyIntensities$Id)
n_distinct(hourlyCalories$Id)
n_distinct(dailySteps$Id)
n_distinct(dailyIntensities$Id)
n_distinct(dailyCalories$Id)
n_distinct(sleepDay$Id)

```
*heartrate_seconds_merged and weightLogInfo both contain substantially low amounts of unique Id's, however sleepDay has 24 which is close enough to our limit so it can still be included in the analysis.

#Data Exploration and Analysis

To get a grasp on the information the datasets contain, I selected specific columns in the data frames and summarized the data within them. This was especially helpful in giving me an idea of what I should expect in the data being dealt with.

```{r summarizing information contained in data sets, echo=TRUE}

dailyActivity %>% 
  select(TotalSteps,
         TotalDistance,
        SedentaryMinutes, Calories) %>% 
  summary()
dailyIntensities %>% 
  select(SedentaryMinutes,
         LightlyActiveMinutes,
         LightActiveDistance) %>% 
  summary()

dailySteps %>% 
  select(StepTotal,
         ActivityDay) %>% 
  summary()

sleepDay %>% 
  select(TotalTimeInBed,
         TotalMinutesAsleep,
         TotalSleepRecords) %>% 
  summary()
hourlyCalories %>% 
  select(Calories) %>% 
  summary()
hourlyIntensities %>% 
  select(TotalIntensity,
         AverageIntensity) %>% 
  summary()
dailyActivity %>% 
  select(LightlyActiveMinutes,
         FairlyActiveMinutes,
         VeryActiveMinutes) %>% 
  summary()
```
Key Takeaways:
*Avg sedentary min is 991, Avg total distance 5.245, Avg cal 2304
*Avg min asleep was 419.5 about 6 hours
*Avg cal per hour 97.39
*Avg total intensity per hour 12.04
*LightlyActiveMinutes has the highest values, signifying that most participants were lightly active more often than being fairly or vary active

After summarizing data I realized some of the datasets had matching information that could be used to merge certain datasets with others, using the merge function I combined them, however I would need to make sure the columns contained the same data.

```{r merging certain datasets, echo=TRUE}
dailyActivity<-dailyActivity %>% 
  rename(Date=ActivityDate)
sleepDay<-sleepDay %>% 
  rename(Date=SleepDay)

activity_sleep <-merge(dailyActivity,sleepDay,by=c("Id","Date"))
head(activity_sleep)
View(activity_sleep)

hourlyActivity <-merge(hourlyCalories,hourlyIntensities,by=c("Id","Date","Time"))
head(hourlyActivity)
View(hourlyActivity)

```

Now we are ready to create our visualizations!

#Data Visualizations

Alongside the summaries above, I used visualizations to find certain connections and draw conclusions on relationships between variables.

```{r TotalSteps v Calories, echo=FALSE}

ggplot(data=dailyActivity)+
geom_smooth(mapping = aes(x=TotalSteps,y=Calories))+labs(title = "TotalSteps v Calories")
```
Here we see a positive relationship between the number of total steps and calories burned, more steps lead to more activity which in turn causes the user to burn more calories.

```{r SedentaryMinutes v TotalMinutesAsleep, echo=FALSE}

ggplot(data = activity_sleep,aes(x=SedentaryMinutes,y=TotalMinutesAsleep))+
  geom_point()+geom_smooth()+labs(title = "SedentaryMinutes v TotalMinutesAsleep")

```
As SedentaryMinutes increased, we saw a decrease in TotalMinutesAsleep, this shows that the less active throughout the day the users are the less sleep they get. 

```{r Calories burned over Hours}

ggplot(data = hourlyActivity,aes(x=Time,y=Calories))+
  geom_histogram(stat = 'identity',fill='pink') + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) + labs(title = "Total Calories Burned Hourly")

```

```{r}

ggplot(data = hourlyActivity,aes(x=Time,y=AverageIntensity))+
  geom_histogram(stat = 'identity',fill='red') + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+labs(title = "AverageIntensity By Hour")

```

In both plots 17:00-19:00 hold the highest values, this signifies that during these hours the users are the most physically active as they have the highest average intensity and most calories lost.

#Summary and Recommendations

Through the data we are able to get a picture of what type of people use fitness tracker devices, working women who find time later in the day to engage in light physical activity. However, there are quite a few limitations on this data, there is some missing data for an ID, 4057192912, which could affect the analysis. Based off what we have there are many things that we can include in Bellabeat products to increrase our presence in the global smart device market

1. Tracking the light activity that so many users engage in would not only be motivation but it would serve to keep progress on things such as weight maintenance and overall physical fitness. These are busy women who spend a good portion of their time remaining sedentary, by marking their progress not only will they be able to gauge themselves it would also encourage them to engage in even more physical activity.

2. It was discovered that many of these users seemed to be more active around the times 17:00-19:00,or 5pm-7pm, by sending notifications around this time Bellabeat can promote more physical activity at a time when the users are done with work.

3. By promoting more activity, sedentary minutes will decrease, earlier in this analysis a relationship between sedentary minutes and total time asleep was found. The more time a user spend being sedentary the less sleep they would get, and the average was about 419.5 min or about 6 hours. This is below the recommended amount of 7-8 hours, so not only will Bellabeat promote a healthier lifestyle, they will help their users sleep alot better at night.

Through these changes and updates, Bellabeat can be more of a health companion rather than just another fitness tracker. This can greatly impact the lives of women who might not have enough time to spend hours in the gym and track how much calories they burn when they go out for a walk.





